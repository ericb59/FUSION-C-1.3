/*
 ___________________________________________________________
/               __           _                              \
|              / _|         (_)                             |
|             | |_ _   _ ___ _  ___  _ __                   |
|             |  _| | | / __| |/ _ \| '_ \                  |
|             | | | |_| \__ \ | (_) | | | |                 |
|             |_|  \__,_|___/_|\___/|_| |_| *               |
|                                                           |
|               The MSX C Library for SDCC                  |
|                 E X A M P L E  C O D E                    |
|                                            FUSION-C v1.2  |
\___________________________________________________________/
*/
// Example : How to use Mouse routine
// 
// Works on MSX2 and upper
//
// Plug a mouse in port 2
// Use Left and right mouse click to draw on screen
//
#include "fusion-c/header/msx_fusion.h"
#include "fusion-c/header/vdp_sprites.h"
#include "fusion-c/header/vdp_graph2.h"
#include <stdio.h>

static MOUSE_DATA mouse;

/*  Set Sprite mouse Pointer  */
static const unsigned char pointer_pattern[]={0x00,0x80,0x40,0x40,0x20,0x20,0x10,0x12,
0x09,0x08,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x80,0x40,0x00,0x00,0x00,0x00,0x00,
0x80,0x40,0x30,0x3C,0x1F,0x1F,0x0E,0x0D,
0x04,0x04,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0x00,0xC0,0x00,0x00,
0x80,0x40,0x20,0x00,0x00,0x00,0x00,0x00,
0x40,0x30,0x0C,0x03,0x00,0x00,0x01,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
0x00,0x00,0x00,0x00,0xC0,0x00,0x00,0x80,
0x40,0x20,0x00,0x00,0x00,0x00,0x00,0x00};




/* --- Slot 0 */
/* mask 0 */
static const unsigned char pattern[]={0x1F,0x10,0x00,0x03,0x00,0x03,0x0B,0x0F,
0x03,0x0C,0x1E,0x11,0x0E,0x01,0x0F,0x1F,
0x20,0x20,0xC0,0x00,0x40,0x40,0x60,0xE0,
0xC0,0x00,0xC0,0xC0,0x80,0x00,0x00,0xE0,

0x00,0x07,0x1E,0x3C,0x3C,0x30,0x40,0x7F,
0x1F,0x3F,0x3F,0x3F,0x3F,0x10,0x1F,0x00,
0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xF0,
0xE0,0xC0,0xE0,0xE0,0xC0,0x00,0x80,0x00,

0x00,0x2F,0x3F,0x7C,0x7F,0x7C,0xF4,0x00,
0x00,0x00,0x00,0x00,0x00,0x3E,0x00,0x00,
0x00,0xD0,0x20,0xC0,0xA0,0xA0,0x90,0x00,
0x00,0x00,0x00,0x00,0x00,0x80,0x00,0x00};


static const unsigned char color1[]={0x01,0x0B,0x0B,0x0B,0x0B,0x0B,0x0B,0x0A,
0x0A,0x06,0x06,0x06,0x0A,0x0B,0x06,0x01};



static const unsigned char color2[]={0x00,0x46,0x46,0x46,0x46,0x46,0x46,0x41,
0x41,0x41,0x41,0x41,0x41,0x46,0x41,0x00};

static const unsigned char color3[]={0x00,0x41,0x41,0x41,0x41,0x41,0x41,0x00,
0x00,0x00,0x00,0x00,0x00,0x41,0x00,0x00};


void main(void)
{
     int mx,my,px,py;
    char a,b;
    signed char dx=0,dy=0;
    a=0;
    b=0;
    px=0;
    py=0;
    dx=0;
    dy=0;


    Screen(5);
    SpriteReset();
    Sprite16();

   
    SetSpritePattern(0,pointer_pattern,96);   // All patterns
    
    SetSpriteColors(0,color1);                // Set Sprites colors
    SetSpriteColors(1,color2);
    SetSpriteColors(2,color3);

    mx=125;
    my=50;
    PutSprite (0,0,mx,my,0);
    PutSprite (1,4,mx,my,0);
    PutSprite (2,8,mx,my,0);



  

    while (Inkey()!=27)   // Escape to Quit
    {
        MouseReadTo(2,&mouse);
        if (mouse.dx!=dx || mouse.dy!=dy) {
          dx=mouse.dx;
          dy=mouse.dy;
          
          px=px-dx;
          if (px>255) px=255;
          if (px<0) px=0;
          
          py=py-dy;
          if (py>211) py=211;
          if (py<0) py=0;
         
         

            PutSprite (0,0,px,py,0);
            PutSprite (1,4,px,py,0);
            PutSprite (2,8,px,py,0);
        }
         if (mouse.rbutton==0)
                Pset(px,py,15,0);
          if (mouse.lbutton==0)
                Pset(px,py,6,0);
    }


    Screen(0);
    Exit(0);
}